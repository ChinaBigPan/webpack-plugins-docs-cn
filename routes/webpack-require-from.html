<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack-require-from | Webpack Plugins</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/webpack-plugins-docs-cn/images/favicon.ico">
    <meta name="description" content="Webpack 除官网外的插件中文文档集，这里或许有你需要的。">
    <link rel="preload" href="/webpack-plugins-docs-cn/assets/css/0.styles.a0a44e73.css" as="style"><link rel="preload" href="/webpack-plugins-docs-cn/assets/js/app.c0a8bf5b.js" as="script"><link rel="preload" href="/webpack-plugins-docs-cn/assets/js/2.dbe3cc13.js" as="script"><link rel="preload" href="/webpack-plugins-docs-cn/assets/js/31.20ca3fff.js" as="script"><link rel="preload" href="/webpack-plugins-docs-cn/assets/js/3.d4396c24.js" as="script"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/10.d844766f.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/11.f4eed091.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/12.7da9e2ae.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/13.244400be.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/14.dcbb64cf.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/15.53a9064f.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/16.69053e1a.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/17.48175a07.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/18.6e4065f5.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/19.2975bfd8.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/20.6956b3a5.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/21.f9d5afc1.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/22.144279a5.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/23.d1650269.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/24.c3a41084.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/25.b7e9b370.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/26.7b718c48.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/27.86d09141.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/28.a769f0ea.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/29.306cd6e2.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/30.3e08a357.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/32.01e3d6c1.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/4.7351e2e0.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/5.01b4c584.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/6.37104416.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/7.2b03a32c.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/8.4073711c.js"><link rel="prefetch" href="/webpack-plugins-docs-cn/assets/js/9.0a841aa1.js">
    <link rel="stylesheet" href="/webpack-plugins-docs-cn/assets/css/0.styles.a0a44e73.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/webpack-plugins-docs-cn/" class="home-link router-link-active"><img src="/webpack-plugins-docs-cn/images/logo.png" alt="Webpack Plugins" class="logo"> <span class="site-name can-hide">Webpack Plugins</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://www.febeacon.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  大笑文档
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/webpack-plugins-docs-cn/" class="nav-link">
  文档首页
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://www.febeacon.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  大笑文档
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/webpack-plugins-docs-cn/" class="nav-link">
  文档首页
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/webpack-plugins-docs-cn/routes/" class="sidebar-link">目录</a></li><li><a href="/webpack-plugins-docs-cn/routes/webpack-build-notifier.html" class="sidebar-link">webpack-build-notifier</a></li><li><a href="/webpack-plugins-docs-cn/routes/friendly-errors-webpack-plugin.html" class="sidebar-link">friendly-errors-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/webpack-jarvis.html" class="sidebar-link">webpack-jarvis</a></li><li><a href="/webpack-plugins-docs-cn/routes/copy-webpack-plugin.html" class="sidebar-link">copy-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/write-file-webpack-plugin.html" class="sidebar-link">write-file-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/prepack-webpack-plugin.html" class="sidebar-link">prepack-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/offline-plugin.html" class="sidebar-link">offline-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/clean-webpack-plugin.html" class="sidebar-link">clean-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/webpack-hook-plugin.html" class="sidebar-link">webpack-hook-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/build-hash-webpack-plugin.html" class="sidebar-link">build-hash-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/webpack-file-manager-plugin.html" class="sidebar-link">webpack-file-manager-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/duplicate-package-checker-webpack-plugin.html" class="sidebar-link">duplicate-package-checker-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/webpack-inject-plugin.html" class="sidebar-link">webpack-inject-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/imagemin-webpack-plugin.html" class="sidebar-link">imagemin-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/svg-sprite-webpack-plugin.html" class="sidebar-link">svg-sprite-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/static-site-generator-webpack-plugin.html" class="sidebar-link">static-site-generator-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/dynamic-cdn-webpack-plugin.html" class="sidebar-link">dynamic-cdn-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/circular-dependency-plugin.html" class="sidebar-link">circular-dependency-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/webpack-require-from.html" class="active sidebar-link">webpack-require-from</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webpack-plugins-docs-cn/routes/webpack-require-from.html#为什么要在运行时更改动态道路的路径？" class="sidebar-link">为什么要在运行时更改动态道路的路径？</a></li><li class="sidebar-sub-header"><a href="/webpack-plugins-docs-cn/routes/webpack-require-from.html#如何使用？" class="sidebar-link">如何使用？</a></li><li class="sidebar-sub-header"><a href="/webpack-plugins-docs-cn/routes/webpack-require-from.html#配置" class="sidebar-link">配置</a></li><li class="sidebar-sub-header"><a href="/webpack-plugins-docs-cn/routes/webpack-require-from.html#全局方法和变量" class="sidebar-link">全局方法和变量</a></li><li class="sidebar-sub-header"><a href="/webpack-plugins-docs-cn/routes/webpack-require-from.html#web-workers" class="sidebar-link">Web Workers</a></li><li class="sidebar-sub-header"><a href="/webpack-plugins-docs-cn/routes/webpack-require-from.html#排忧解难" class="sidebar-link">排忧解难</a></li></ul></li><li><a href="/webpack-plugins-docs-cn/routes/dynamic-vendor-webpack-plugin.html" class="sidebar-link">dynamic-vendor-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/define-variable-webpack-plugin.html" class="sidebar-link">define-variable-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/hook-shell-script-webpack-plugin.html" class="sidebar-link">hook-shell-script-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/stylelint-webpack-plugin.html" class="sidebar-link">stylelint-webpack-plugin</a></li><li><a href="/webpack-plugins-docs-cn/routes/eslint-webpack-plugin.html" class="sidebar-link">eslint-webpack-plugin</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack-require-from">webpack-require-from <span class="badge tip" style="vertical-align:top;" data-v-76a02c50>v 1.8.1</span></h1> <p>允许为获取动态导入配置路径或 URL 的 webpack 插件。</p> <p>在运行时控制动态导入的路径/URL</p> <ul><li>支持 webpack 5，4，3，2</li> <li>支持 <a href="https://github.com/webpack-contrib/worker-loader" target="_blank" rel="noopener noreferrer">web-worker 加载<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>生产环境OK。</li> <li>无依赖。</li> <li>轻量。</li> <li>测试完备。</li></ul> <h2 id="为什么要在运行时更改动态道路的路径？">为什么要在运行时更改动态道路的路径？</h2> <p>Webpack 允许使用<code>[require.ensure][require.ensure]</code>或<a href="https://webpack.js.org/guides/code-splitting/#dynamic-imports" target="_blank" rel="noopener noreferrer">dynamic import<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><code>import()</code>来自动分割和加载代码。当你的主包在浏览器中运行时，模块以“按需”方式获取。</p> <p>Webpack 根据配置中的<code>config.output.publicPath</code>从静态 URL 加载模块(包块)。</p> <p>有些时候您需要在运行时控制模块(包块)的加载，举个例子：</p> <ul><li>包块(chunks)托管在 CDN 上。</li> <li>不同的环境使用的 URL 来加载静态资源(生产环境，测试环境等)。</li> <li>您的<code>index</code>文件来自不同的域名/端口。</li> <li>您需要从不同的域名动态加载预编译文件。</li> <li>您需要从 CDN 加载第三方的 web worker。</li></ul> <h2 id="如何使用？">如何使用？</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> WebpackRequireFrom <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-require-from&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpackRequireFromConfig <span class="token operator">=</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    publicPath<span class="token punctuation">:</span> <span class="token string">&quot;/webpack/&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">WebpackRequireFrom</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 参见下方配置</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="配置">配置</h2> <p>如果没有传入任何配置项，那么该插件将默认使用<code>[config.output.publicPath](https://webpack.js.org/guides/public-path/#on-the-fly)</code>。</p> <h3 id="path"><code>path</code></h3> <p>为动态加载模块设置路径。您传入的值将在动态导入代码块时替换<code>config.output.publicPath</code>。</p> <p>举个例子，如果默认的 URL 是<code>https://localhost</code>，包名是<code>0.js</code>同时配置对象为<code>{path: &quot;customPath/&quot; }</code>，那么代码块将从<code>https://localhost/customPath/0.js</code>获取。</p> <blockquote><p><strong>注意：</strong> <code>path</code> / <code>methodName</code> / <code>variableName</code>这三个配置项是互斥的，不可同时使用。</p></blockquote> <h3 id="variablename"><code>variableName</code></h3> <p><code>variableName</code>是全局定义的变量，它会在运行时进行计算，<code>variableName</code>是变量的名称，带有字符串的值表示路径/URL，它们用于动态导入代码块。</p> <p>举个例子，如果默认的 URL 是<code>https://localhost</code>，包名是<code>0.js</code>同时配置对象为<code>{variableName: &quot;chunkURL&quot; }</code>，同时<code>window.chunkURL</code>将定义为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span>chunkURL <span class="token operator">=</span> <span class="token string">&quot;https://app.cdn.com/buildXXX/&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>代码块将从<code>https://app.cdn.com/buildXXX/0.js</code>获取。</p> <h3 id="methodname"><code>methodName</code></h3> <p>全局定义的方法名，它将在运行时调用，该方法应该返回动态导入的代码块的路径/URL。</p> <p>举个例子，如果默认的 URL 是<code>https://localhost</code>，包名是<code>0.js</code>，配置项为<code>{methodName: &quot;getChunkURL&quot; }</code>，同时<code>window.getChunkURL</code>将定义为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">getChunkURL</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用任何条件来选择URL</span>
    <span class="token keyword">return</span> <span class="token string">&quot;https://app.cdn.com/buildXXX/&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>代码块将从<code>https://app.cdn.com/buildXXX/0.js</code>获取。</p> <p>如果与<code>replaceSrcMethodName</code>一起使用，chunk URL 将首先被 <code>window[methodName]</code>修改，然后修改的值作为一个参数传递给<code>window[replaceSrcMethodName]</code>函数。</p> <blockquote><p><strong>注意：</strong> <code>path</code> / <code>methodName</code> / <code>variableName</code>这三个配置项是互斥的，不可同时使用。</p></blockquote> <blockquote><p><strong>注意：</strong> 该方法应该在全局命名空间中定义，并且应该在调用<code>require.ensure</code>或<code>import()</code>之前定义。请参见下面的例子:</p></blockquote> <h3 id="replacesrcmethodname"><code>replaceSrcMethodName</code></h3> <p>全局定义的方法名，它将在运行时调用，该方法接收动态引入的代码块的<strong>完整URL</strong>作为其参数并返回新 URL 的字符串。</p> <p>举个例子，如果默认的 URL 是<code>https://localhost</code>，包名是<code>0.js</code>和<code>common.js</code>，配置项为<code>{replaceSrcMethodName: &quot;replaceSrc&quot; }</code>，同时<code>window.replaceSrc</code>将定义为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">replaceSrc</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">originalSrc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>originalSrc<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/common/</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 对指定的 chunk 进行重命名</span>
    <span class="token keyword">return</span> originalSrc<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/common/</span><span class="token punctuation">,</span> <span class="token string">&quot;static&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originalSrc<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>代码块将从<code>https://localhost/0.js</code>和<code>https://localhost/static.js</code>获取。</p> <p>如果同时使用了<code>methodName</code>或<code>variableName</code>，chunk URL 将首先被 <code>window[methodName]</code>修改亦或是修改为<code>window[variableName]</code>，然后修改的值作为一个参数传递给<code>window[replaceSrcMethodName]</code>函数。</p> <blockquote><p><strong>注意：</strong> 该方法应该在全局命名空间中定义，并且应该在调用<code>require.ensure</code>或<code>import()</code>之前定义。</p></blockquote> <h3 id="supresserrors"><code>supressErrors</code></h3> <p>默认值<code>false</code>。当无法检测到您在<code>replaceSrcMethodName</code>、<code>methodName</code>或<code>variableName</code>中定义的方法名时，插件将调用<code>console.error</code>。打开该配置项将压制错误信息。</p> <h2 id="全局方法和变量">全局方法和变量</h2> <p>当您的 JS 代码在浏览器中执行时，您作为<code>variableName</code>、<code>methodName</code>或<code>replaceSrcMethodName</code>值的方法/变量名应该在第一次调用<code>require.ensure()</code>或<code>import()</code>执行<strong>之前</strong>设置。</p> <p>方法的返回值将用于构建获取资源的 URL。</p> <p>例如，在执行主包之前我们可以定义一个<code>veryFirst</code>的全局方法：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> window<span class="token punctuation">.</span><span class="token function-variable function">veryFirst</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;I am very first!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>您可以使用单独的文并使用 webpack 的配置项：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 文件名: veryFirst.js</span>
<span class="token keyword">const</span> window<span class="token punctuation">.</span><span class="token function-variable function">veryFirst</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;I am very first!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token string">'./veryFirst.js'</span><span class="token punctuation">,</span> <span class="token string">'./index.js'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>另一个方法是在服务端构建时将<code>veryFirst</code>定义为<code>index.html</code>的一部分：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 文件名：server/app.js</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">&quot;views/index&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    cdnPath<span class="token punctuation">:</span> <span class="token string">&quot;https://qa.cdn.com/|https://prod.cdn.com/&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 文件名: views/index.ejs --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">const</span> baseCDN <span class="token operator">=</span> <span class="token string">&quot;&lt;%= cdnPath %&gt;&quot;</span><span class="token punctuation">;</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">veryFirst</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>baseCDN<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/js/</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="web-workers">Web Workers</h2> <p>使用<code>replaceSrcMethodName</code>提供一个修改 web-worker 加载路径的方法。该方法必须是全局可用的，并且必须在 web-worker 内的<code>import()</code>调用之前定义。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* webpack.config.js */</span>
  <span class="token comment">// ...</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/worker\.js$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          loader<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">worker-loader</span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">RequireFrom</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      replaceSrcMethodName<span class="token punctuation">:</span> <span class="token string">&quot;getSrc&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
  <span class="token comment">// ...</span>


<span class="token comment">/* worker.js */</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./globals.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./worker-module.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">workerModule</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  workerModule<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;loaded workerModule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p><strong>详细信息</strong></p> <p>该插件允许更改加载 web-worker 的路径。</p> <p>为达成这个需求，使用了<code>[worker-loader][worker-loader]</code>加载器。该加载器使用<code>[importScripts][importScripts]</code>从您的 web-worker 中动态加载模块，并支持<a href="https://benohead.com/cross-domain-cross-browser-web-workers/" target="_blank" rel="noopener noreferrer">跨域web worker<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。更具体地说：</p> <ol><li>创建一个新的 webpack 入口，它只包含<code>new Worker(workerURL)</code>，而<code>workerURL</code>是您的主要 webworker 模块。</li> <li>用 webpack 运行时工具增强您的 webworker 主模块。</li> <li>使用<code>importScripts</code>在 webworker 上下文中动态加载新模块(从而避免跨域限制)。</li></ol> <p>该插件重写了<code>importScript</code>并调用您在<code>replaceSrcMethodName</code>中定义的方法。您提供的方法将在调用<code>importScripts</code>之前被调用，所需的模块路径作为单个参数。</p> <p>您可以在<a href="https://github.com/sushain97/web2fs-notepad/commit/06b3ece074f1c1c96d9bb75436181147943f6026#diff-028b78cada5fa9a59260b989f3b86ffeR52" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>找到本插件联动 web worker 的应用实例。</p> <h2 id="排忧解难">排忧解难</h2> <blockquote><p>${methodName}不是函数，或者在运行时不可用。</p></blockquote> <ul><li>确保<code>webpack.config.js</code>中的方法名与在全局<code>window</code>对象中定义的方法名匹配。</li> <li>确保在第一次调用<code>require.ensure()</code>或<code>import()</code><strong>之前</strong>定义该方法。</li></ul> <blockquote><p>配置<code>methodName</code>或<code>path</code>中的一个，不要两者都配置。</p></blockquote> <ul><li><code>path</code>和<code>methodName</code>是互斥的，不能一起使用，随便使用一个就行。</li></ul> <blockquote><p>${methodName} 不返回字符串。</p></blockquote> <ul><li>当使用<code>replaceSrcMethodName</code>配置项时，调用<code>window[replaceSrcMethodName]</code>的结果将被验证——它应该被定义并且是一个字符串。</li> <li>确保您从<code>window[replaceSrcMethodName]</code>返回一个字符串值。</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/webpack-plugins-docs-cn/routes/circular-dependency-plugin.html" class="prev">
        circular-dependency-plugin
      </a></span> <span class="next"><a href="/webpack-plugins-docs-cn/routes/dynamic-vendor-webpack-plugin.html">
        dynamic-vendor-webpack-plugin
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/webpack-plugins-docs-cn/assets/js/app.c0a8bf5b.js" defer></script><script src="/webpack-plugins-docs-cn/assets/js/2.dbe3cc13.js" defer></script><script src="/webpack-plugins-docs-cn/assets/js/31.20ca3fff.js" defer></script><script src="/webpack-plugins-docs-cn/assets/js/3.d4396c24.js" defer></script>
  </body>
</html>
