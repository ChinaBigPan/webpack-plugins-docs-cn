(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{366:function(t,e,s){"use strict";s.r(e);var a=s(43),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"offline-plugin"}},[t._v("offline-plugin  "),s("Badge",{attrs:{text:"v 5.0.7"}})],1),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/NekR/offline-plugin",target:"_blank",rel:"noopener noreferrer"}},[t._v("插件的GitHub"),s("OutboundLink")],1)]),t._v(" "),s("img",{staticStyle:{verticalAlign:"middle",display:"block",margin:"0 auto"},attrs:{width:"150",src:"/webpack-plugins-docs-cn/images/offline_plugin_logo.png"}}),t._v(" "),s("p",[t._v("本插件旨在为"),s("code",[t._v("webpack")]),t._v("项目提供离线体验。它利用了"),s("code",[t._v("ServiceWorker")]),t._v("和"),s("code",[t._v("AppCache")]),t._v("作为后台备份。只需要在您的"),s("code",[t._v("webpack.config.js")]),t._v("中引入这个插件，并在客户端脚本中包含相应的"),s("code",[t._v("runtime(运行时)")]),t._v("。通过缓存所有(或部分) "),s("code",[t._v("webpack")]),t._v("输出的资源，您的项目就可以离线了。")]),t._v(" "),s("h2",{attrs:{id:"安装"}},[t._v("安装")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" offline-plugin "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--save-dev"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h2",{attrs:{id:"设置"}},[t._v("设置")]),t._v(" "),s("p",[t._v("首先，在您的"),s("code",[t._v("webpack.config.js")]),t._v("中实例化插件。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" OfflinePlugin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'offline-plugin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n\n  plugins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ... 其他插件")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// OfflinePlugin 是最后一个添加的比较好")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OfflinePlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("p",[t._v("然后，将"),s("code",[t._v("运行时(runtime)")]),t._v("添加到入口文件(通常是主入口)：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'offline-plugin/runtime'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("ES6/Babel/TypeScript")]),t._v(" "),s("div",{staticClass:"language-ts line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" OfflinePluginRuntime "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'offline-plugin/runtime'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nOfflinePluginRuntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("下面示例展示如何设置配置项(TypeScript)：")]),t._v(" "),s("div",{staticClass:"language-ts line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" OfflinePluginRuntime "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'offline-plugin/runtime'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nOfflinePluginRuntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onUpdateReady")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" OfflinePluginRuntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("applyUpdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onUpdated")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" location"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reload")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("p",[t._v("如果你需要手动解决"),s("code",[t._v("TypeScript")]),t._v("定义文件，那么你可以添加这一行到你的"),s("code",[t._v("ts")]),t._v("文件:")]),t._v(" "),s("div",{staticClass:"language-ts line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/// <reference path="node_modules/offline-plugin/runtime.d.ts" />')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h2",{attrs:{id:"文档"}},[t._v("文档")]),t._v(" "),s("h3",{attrs:{id:"配置项-options"}},[t._v("配置项(options)")]),t._v(" "),s("p",[t._v("这些配置项都是可选的，"),s("a",{attrs:{href:"https://github.com/NekR/offline-plugin/blob/master/src/default-options.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里是默认设置"),s("OutboundLink")],1)]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("名称")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("默认值")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("appShell")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("string")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("null")]),t._v(" "),s("td",[t._v("以"),s("a",{attrs:{href:"https://developers.google.com/web/fundamentals/architecture/app-shell",target:"_blank",rel:"noopener noreferrer"}},[t._v("app shell model"),s("OutboundLink")],1),t._v("启动您的应用。可以设置为希望所有导航请求都返回的 HTML 文件。例如："),s("code",[t._v("/app-shell.html")]),t._v("。后面会详述。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("responseStrategy")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("cache-first | network-first")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("cache-first")])]),t._v(" "),s("td",[t._v("若设置为"),s("code",[t._v("cache-first")]),t._v("，则所有的请求均优先检查缓存，如果缓存是空的，则请求网络。若使用"),s("code",[t._v("network-first")]),t._v("，所有请求首先发送到网络，如果网络请求失败，则查询缓存作为回退。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("externals")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("Array<string>")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("null")]),t._v(" "),s("td",[t._v("指定要缓存的其他(构建过程中的外部)URL. "),s("br"),t._v(" 例如："),s("code",[t._v("['/static/img/media.png', 'https://fonts.googleapis.com/css?family=Roboto']")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("excludes")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("Array<string | globs_pattern>")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("['**/.*', '**/*.map', '**/*.gz']")])]),t._v(" "),s("td",[t._v("将哪些文件排除出缓存。以"),s("code",[t._v(".")]),t._v("开头和以"),s("code",[t._v(".map")]),t._v("或"),s("code",[t._v(".gz")]),t._v("为结尾的文件则被排除在外。"),s("br"),t._v(" ⚠️注意：该项是在"),s("code",[t._v("rewrites")]),t._v("之前起作用的。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("autoUpdate")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("true | number")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("false")])]),t._v(" "),s("td",[t._v("启用 ServiceWorker 和 AppCache 的自动更新。如果设置为"),s("code",[t._v("true")]),t._v("，则默认"),s("strong",[t._v("1小时")]),t._v("间隔。我们可以传入数字来自定义更新间隔。"),s("br"),t._v(" 请注意：如果用户在您的网站上打开了多个标签，那么更新可能发生的更频繁，因为每个打开的标签都有自己的更新间隔。 "),s("br"),s("br"),t._v(" 示例："),s("code",[t._v("true")]),t._v(" "),s("br"),t._v(" 示例："),s("code",[t._v("1000 * 60 * 60 * 5")]),t._v("(五小时)")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("relativePaths")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("boolean")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("true")])]),t._v(" "),s("td",[t._v("当设置为"),s("code",[t._v("true")]),t._v("时，缓存中生成的所有路径是分别相对于 ServiceWorker 文件或 AppCache 文件夹位置。 "),s("br"),s("br"),t._v(" 当设置了"),s("code",[t._v("publicPath")]),t._v("时，该项被忽略。而当该项设置为"),s("code",[t._v("true")]),t._v("时，则是"),s("code",[t._v("publicPath")]),t._v("被忽略。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("rewrites")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("Function | Object")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("Rewrite "),s("code",[t._v("/index.html")]),t._v(" to "),s("code",[t._v("/")])]),t._v(" "),s("td",[t._v("提供一种更改加载资源URL的方式。当资源与客户期望有差异时，就需要它出场了。比方说CDN。后面会详述。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("cacheMaps")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("Array<Object>")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",[t._v("后面会详述。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("ServiceWorker")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("Object | null | false")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",[t._v("内容表格放不下，后面详述。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("publicPath")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("string")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",[t._v("和"),s("code",[t._v("webpack")]),t._v("的"),s("code",[t._v("output.publicPath")]),t._v("配置项类似。专门为 offline-plugin 指定或覆盖"),s("code",[t._v("publicPath")]),t._v("时非常有用。当未设置时，使用"),s("code",[t._v("webpack")]),t._v("的"),s("code",[t._v("output.publicPath")]),t._v("。当完全没有指定"),s("code",[t._v("publicPath")]),t._v("值时(无论是通过这个选项还是通过"),s("code",[t._v("webpack")]),t._v("的输出)，使用相对路径(参见"),s("code",[t._v("relativePaths")]),t._v(")。"),s("br"),s("br"),t._v(" 示例："),s("code",[t._v("publicPath: /project/")]),t._v(" "),s("br"),t._v(" 示例："),s("code",[t._v("publicPath: 'https://example.com/project'")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("version")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("string | (plugin: OfflinePlugin) => void")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("当前时间和日期")]),t._v(" "),s("td",[t._v("缓存的版本。可以是函数，这在需要应用动态值的观察模式下非常有用。 "),s("br"),s("br"),t._v(" · 若是函数，则在调用时将插件实例作为第一个参数。 "),s("br"),t._v(" · 若是字符串，可以插入"),s("code",[t._v("[hash]")]),t._v("标记。 "),s("br"),s("br"),t._v(" 示例："),s("code",[t._v("2018-6-20 09:53:56")]),t._v(" "),s("br"),t._v(" 请注意如果您使用了默认值(date和time)，那么 service worker 的版本会在您每次构建项目时改变。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("caches")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("'all' | Object")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("'all'")])]),t._v(" "),s("td",[t._v("允许您调整缓存资源的内容和方式. "),s("br"),s("br"),t._v(" · "),s("code",[t._v("'all'")]),t._v("：意味着在外部配置项中列出的所有项目(所有"),s("code",[t._v("webpack")]),t._v("输出资产)和"),s("code",[t._v("URL")]),t._v("都将在安装时缓存。 "),s("br"),t._v(" · "),s("code",[t._v("Object")]),t._v("：对象有三个可能的"),s("code",[t._v("Array<string | RegExp>")]),t._v("字段："),s("code",[t._v("main")]),t._v("、"),s("code",[t._v("additional")]),t._v("、"),s("code",[t._v("optional")]),t._v("。所有的字段都是可选且默认为空的。更多内容后面详述。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("AppCache")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("Object | null | false")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",[t._v("设置"),s("code",[t._v("AppCache")]),t._v("缓存的设置。设置为"),s("code",[t._v("null")]),t._v("或"),s("code",[t._v("false")]),t._v("则禁用"),s("code",[t._v("AppCache")]),t._v("生成。更多内容后面详述。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("updateStrategy")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("'changed' | 'all'")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("'changed'")])]),t._v(" "),s("td",[t._v("缓存更新策略。"),s("strong",[t._v("请不要更改此选项，除非您确信您知道自己在做什么。")]),t._v(" 后面也有详述。")])])])]),t._v(" "),s("h3",{attrs:{id:"配置项详述部分"}},[s("strong",[t._v("配置项详述部分")])]),t._v(" "),s("p",[s("strong",[s("code",[t._v("appShell: string")])])]),t._v(" "),s("blockquote",[s("p",[t._v("默认："),s("code",[t._v("null")]),t._v('\n示例："/"')])]),t._v(" "),s("p",[t._v("在制作单页应用时，通常使用"),s("a",{attrs:{href:"https://developers.google.com/web/fundamentals/architecture/app-shell",target:"_blank",rel:"noopener noreferrer"}},[t._v("app shell model"),s("OutboundLink")],1),t._v("模式。")]),t._v(" "),s("p",[t._v("为了让"),s("code",[t._v("offline-plugin")]),t._v("将所有位置的导航请求重定向到特定的缓存，我们可以配置"),s("code",[t._v("appShell")]),t._v("项，比方说:"),s("code",[t._v("appShell: '/'")])]),t._v(" "),s("h4",{attrs:{id:"ssr"}},[t._v("SSR")]),t._v(" "),s("p",[t._v("当使用"),s("code",[t._v("AppShell")]),t._v("模型进行服务端渲染时，请确保不会缓存任何服务端渲染的数据。其中最简单的方法是创建一个没有任何服务端渲染数据的HTML文件路由并进行缓存。例如："),s("code",[t._v("appShell: '/app-shell.html'")])]),t._v(" "),s("h4",{attrs:{id:"advanced"}},[t._v("Advanced")]),t._v(" "),s("p",[s("code",[t._v("appShell")]),t._v("是"),s("code",[t._v("cacheMaps")]),t._v("项为"),s("code",[t._v("ServiceWorker")]),t._v("准备的，而"),s("code",[t._v("AppCache.FallBack")]),t._v("则对应"),s("code",[t._v("AppCache")]),t._v("。")]),t._v(" "),s("p",[s("strong",[s("code",[t._v("rewrites")])])]),t._v(" "),s("p",[t._v("该回调将迭代"),s("code",[t._v("assets")]),t._v("和由插件生成的serviceWorker文件中的"),s("code",[t._v("external")]),t._v("数组。这可以帮助开发人员根据场景修改资源，比如为多个资源设置多个 CDN。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("rewrites")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("asset")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\t\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("asset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("endsWith")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://www.qq.com/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" asset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://s1.url.cn/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" asset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" asset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("p",[s("strong",[s("code",[t._v("cacheMaps")])])]),t._v(" "),s("p",[t._v("该项允许将请求重定向到缓存或另一个请求。假设您正在使用"),s("a",{attrs:{href:"https://medium.com/google-developers/instant-loading-web-apps-with-an-application-shell-architecture-7c0c2f10c73",target:"_blank",rel:"noopener noreferrer"}},[t._v("App-Shell模式"),s("OutboundLink")],1),t._v("开发您的网站，并且使用您的 app-shell 缓存首页"),s("code",[t._v("/")]),t._v("。现在当用户访问"),s("code",[t._v("/something-else")]),t._v("时，我们需要从缓存中提供相同的 app-shell。通过"),s("code",[t._v("cacheMaps")]),t._v("可以轻松办到：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OfflinePlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    cacheMaps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("match")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("requestUrl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" location"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            requestTypes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'navigate'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("p",[t._v("注意，这个功能是通过"),s("a",{attrs:{href:"https://github.com/NekR/offline-plugin/blob/master/docs/app-shell.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("appShell"),s("OutboundLink")],1),t._v("配置项实现的，所以如果没有更复杂需求的话，您应该更喜欢它。")]),t._v(" "),s("p",[t._v("可用的属性：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("match")]),t._v(": string | RegExp | function -- 匹配 URL 以映射到缓存。如果是函数，那么它接受2个参数：请求的"),s("code",[t._v("URL")]),t._v("对象以及"),s("code",[t._v("Request")]),t._v("本身。函数的返回值作为新的"),s("code",[t._v("URL")]),t._v("。它"),s("strong",[t._v("必须")]),t._v("是一个"),s("code",[t._v("URL")]),t._v("对象。")]),t._v(" "),s("li",[s("code",[t._v("to")]),t._v(": string | function -- 仅当"),s("code",[t._v("match")]),t._v("不是函数时使用。每个 URL 都和"),s("code",[t._v("urlString.replace(map.match, map.to)")]),t._v("相匹配，因此"),s("code",[t._v("to")]),t._v("配置项实际是请求url时调用的"),s("code",[t._v("String.replace")]),t._v("函数的第二个参数。")]),t._v(" "),s("li",[s("code",[t._v("requestType")]),t._v(" Array -- 此次映射应当使用的请求类型数组。可以是任何值的组合: "),s("code",[t._v("navigare")]),t._v("、"),s("code",[t._v("same-origin")]),t._v("、"),s("code",[t._v("cross-origin")]),t._v("。示例："),s("code",[t._v("requestTypes: ['navigate', 'same-origin']")])])]),t._v(" "),s("p",[s("strong",[s("code",[t._v("Caches")])])]),t._v(" "),s("p",[s("code",[t._v("caches: 'all' | Object")])]),t._v(" "),s("p",[t._v("告诉插件哪些需要缓存及如何缓存。")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("'all'")]),t._v("：意味着在外部配置项中列出的所有项目(所有"),s("code",[t._v("webpack")]),t._v("输出资产)和"),s("code",[t._v("URL")]),t._v("都将在安装时缓存。")]),t._v(" "),s("li",[s("code",[t._v("Object")]),t._v("：对象有三个可能的"),s("code",[t._v("Array<string | RegExp>")]),t._v("字段："),s("code",[t._v("main")]),t._v("、"),s("code",[t._v("additional")]),t._v("、"),s("code",[t._v("optional")]),t._v("。所有的字段都是可选且默认为空的。")])]),t._v(" "),s("p",[s("strong",[t._v("高级用法")])]),t._v(" "),s("p",[t._v("传递"),s("code",[t._v("Object")]),t._v("以自定义构建资源的方法。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("caches"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':rest:'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  additional"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':externals:'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  optional"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*.chunk.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("在这个例子中，以"),s("code",[t._v("chunk.js")]),t._v("结尾的资源被列入"),s("code",[t._v("optional")]),t._v("缓存中，外部资源则归为"),s("code",[t._v("additional")]),t._v("缓存，其余的则列为"),s("code",[t._v("main")]),t._v("缓存。")]),t._v(" "),s("p",[t._v("特殊关键字"),s("code",[t._v(":rest")]),t._v("来匹配所有"),s("code",[t._v("未使用/未缓存")]),t._v("的静态资源。若要匹配多个资源或动态名称的资源，请使用"),s("a",{attrs:{href:"https://www.npmjs.com/package/minimatch",target:"_blank",rel:"noopener noreferrer"}},[t._v("模式匹配"),s("OutboundLink")],1),t._v("。若添加(不属于"),s("code",[t._v("webpack")]),t._v("构建流程内的)外部资源，请在"),s("code",[t._v("externals")]),t._v("中列出它们，然后再缓存中使用"),s("code",[t._v(":externals")]),t._v("关键字。如果你不想把所有"),s("code",[t._v("externals")]),t._v("都放到同一个部分，那么可以单独列出(示例："),s("code",[t._v("additional: ['/external.js']")]),t._v(")而非使用"),s("code",[t._v(":externals")]),t._v("关键字。")]),t._v(" "),s("p",[s("strong",[t._v("Cache sections")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("main")]),t._v(": 首先缓存这部分列出的资源("),s("code",[t._v("ServiceWorker")]),t._v("的"),s("code",[t._v("install")]),t._v("事件)，如果这部分缓存失败————则不会缓存任何资源。因此，这里应包含最重要的资源(如："),s("code",[t._v("['index.html', 'main.js']")]),t._v(")，没这些网站就歇菜的那种。")]),t._v(" "),s("li",[s("code",[t._v("additional")]),t._v(": "),s("strong",[t._v("默认情况下仅在 "),s("code",[t._v("ServiceWorker")]),t._v(" 中启用")]),t._v("。该部分的资源是在"),s("code",[t._v("main")]),t._v("部分成功加载之后才加载的("),s("code",[t._v("ServiceWorks")]),t._v("的"),s("code",[t._v("activate")]),t._v("事件)。如果有任何资源加载失败，则不会从本部分缓存任何内容，并且所有资源都会被移动到"),s("code",[t._v("optional")]),t._v("部分。如果更改了"),s("strong",[t._v("当前更新策略")]),t._v("，则下载失败的资源会被移动到"),s("code",[t._v("optional")]),t._v("部分，所有其他的资源则成功缓存。")]),t._v(" "),s("li",[s("code",[t._v("optional")]),t._v(": "),s("strong",[t._v("默认情况下仅在 "),s("code",[t._v("ServiceWorker")]),t._v(" 中启用")]),t._v("。只有从服务器时才缓存的资源。"),s("code",[t._v("ServiceWorker")]),t._v("不会提前下载。")])]),t._v(" "),s("blockquote",[s("p",[t._v("注意：AppCache 不支持有条件或延迟的资源加载，默认情况下忽略"),s("code",[t._v("additional")]),t._v("和"),s("code",[t._v("optional")]),t._v("部分中的资源。要使AppCache缓存所有部分，请设置此选项:")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("AppCache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  caches"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'main'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'additional'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'optional'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[s("strong",[s("code",[t._v("ServiceWorker: Object | null | false")])])]),t._v(" "),s("p",[t._v("设置"),s("code",[t._v("ServiceWorker")]),t._v("的缓存。设置"),s("code",[t._v("null")]),t._v("和"),s("code",[t._v("false")]),t._v("可以禁用"),s("code",[t._v("ServiceWorker")]),t._v("。")]),t._v(" "),s("ul",[s("li",[s("strong",[s("code",[t._v("output")])]),t._v(": "),s("code",[t._v("string")]),t._v("。配发脚本的相对输出路径("),s("code",[t._v("webpack")]),t._v("配置中的"),s("code",[t._v("output.path")]),t._v(")。 默认："),s("code",[t._v("'sw.js'")])]),t._v(" "),s("li",[s("strong",[s("code",[t._v("entry")])]),t._v(": "),s("code",[t._v("string")]),t._v("。作为"),s("code",[t._v("ServiceWorker")]),t._v("入口/引导文件的相对或绝对路径。对于实现"),s("code",[t._v("ServiceWorker")]),t._v("事件的额外功能和句柄如"),s("code",[t._v("push")]),t._v("、"),s("code",[t._v("sync")]),t._v("等非常有用。默认："),s("code",[t._v("空文件")]),t._v(".")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("scope")])]),t._v(": "),s("code",[t._v("string")]),t._v("。"),s("strong",[t._v("该项十分危险！")]),t._v("。在将"),s("code",[t._v("ServiceWorker")]),t._v("部署到生产环境后，不应该更改此选项。更改它可能会损坏缓存，并在用户的设备上留下旧的缓存。当需要在同一域中运行多个项目时，此选项非常有用。默认："),s("code",[t._v("''")]),t._v("。示例："),s("code",[t._v("'my-project'")]),t._v("。")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("events")])]),t._v(": "),s("code",[t._v("boolean")]),t._v("。为"),s("code",[t._v("ServiceWorker")]),t._v("启用运行时事件。有关受支持的事件，请参阅"),s("a",{attrs:{href:"https://github.com/NekR/offline-plugin/blob/master/docs/runtime.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("运行时"),s("OutboundLink")],1),t._v("的"),s("code",[t._v("install()")]),t._v("选项。默认值："),s("code",[t._v("false")])]),t._v(" "),s("li",[s("strong",[s("code",[t._v("publicPath")])]),t._v(": "),s("code",[t._v("string")]),t._v("。提供一种覆盖服务器上"),s("code",[t._v("ServiceWorker")]),t._v("脚本文件位置的方式。应该是生成"),s("code",[t._v("ServiceWorker")]),t._v("的确切路径。默认："),s("code",[t._v("null")]),t._v("。示例："),s("code",[t._v("'/my/new/path/sw.js'")])]),t._v(" "),s("li",[s("strong",[s("code",[t._v("navigationPreload")])]),t._v(": "),s("code",[t._v("boolean | Object | ':auto'")]),t._v(". 参见"),s("a",{attrs:{href:"https://github.com/NekR/offline-plugin/blob/master/docs/navigation-preload.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("ServiceWorker.navigationPreload"),s("OutboundLink")],1),t._v("，默认："),s("code",[t._v("auto")])]),t._v(" "),s("li",[s("strong",[s("code",[t._v("prefetchRequest")])]),t._v(": "),s("code",[t._v("Object")]),t._v("。为预请求提供一种可以指定"),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Request/Request",target:"_blank",rel:"noopener noreferrer"}},[t._v("请求初始配置项"),s("OutboundLink")],1),t._v("的方式(在"),s("code",[t._v("install")]),t._v("事件中的预缓存请求。)。可选值："),s("code",[t._v("credentials")]),t._v("、"),s("code",[t._v("headers")]),t._v("、"),s("code",[t._v("mode")]),t._v("、"),s("code",[t._v("cache")]),t._v("。默认: "),s("code",[t._v("{ credentials: 'omit', mode: 'cors' }")]),t._v("。示例："),s("code",[t._v("{ credentials: 'include' }")])]),t._v(" "),s("li",[s("strong",[s("code",[t._v("minify")])]),t._v("："),s("code",[t._v("boolean")]),t._v("。 如果设置为"),s("code",[t._v("true")]),t._v("或"),s("code",[t._v("false")]),t._v(", "),s("code",[t._v("ServiceWorker")]),t._v("的输出将相应地压缩或不压缩。如果您使用了"),s("code",[t._v("webpack.optimization.UglifyJsPlugin")]),t._v("或"),s("code",[t._v("terser-webpack-plugin")]),t._v("的话，设置为其他值，"),s("code",[t._v("ServiceWorker")]),t._v("输出将被压缩，。默认值："),s("code",[t._v("null")]),t._v("。")])]),t._v(" "),s("p",[s("strong",[s("code",[t._v("runtime(运行时)")])])]),t._v(" "),s("p",[s("strong",[t._v("install(options: Object)")])]),t._v(" "),s("p",[t._v("开始"),s("code",[t._v("ServiceWorker")]),t._v("/"),s("code",[t._v("AppCache")]),t._v("的安装流。它虽然安全，但每次你的页面加载时都会调用(不要把它包装到任何条件中)。")]),t._v(" "),s("p",[s("strong",[t._v("applyUpdate()")])]),t._v(" "),s("p",[t._v("用于为现有安装应用更新。参见下面的"),s("code",[t._v("install")]),t._v("配置项。")]),t._v(" "),s("p",[s("strong",[t._v("update()")])]),t._v(" "),s("p",[t._v("检查新"),s("code",[t._v("ServiceWorker/AppCache")]),t._v("的更新。")]),t._v(" "),s("p",[s("strong",[t._v("install()的配置项(options)")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" OfflinePluginRuntime "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'offline-plugin/runtime'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nOfflinePluginRuntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onInstalled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 事件在安装 ServiceWorker 或 AppCache 时被调用一次。可用于显示“App已准备好脱机使用”消息。")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onUpdating")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// AppCache 不支持这一事件。当发现更新并且浏览器开始更新进程时调用。此时，一些资源正在下载。")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onUpdateReady")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当 onupdating 阶段完成时调用。此时所有必需的资源都已下载并准备好进行更新。调用 runtime.applyUpdate() 来应用更新。")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onUpdateFailed")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当 onupdating 阶段因某种原因失败时调用。此时没有下载任何东西，您的代码中的当前更新过程应该被取消或忽略。")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onUpdated")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当应用更新时，通过调用 runtime.applyUpdate() 或浏览器本身的其他方式调用。")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])])])}),[],!1,null,null,null);e.default=n.exports}}]);